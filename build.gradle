plugins {
    id 'java'
    id "com.github.johnrengelman.shadow" version "6.1.0"
}

group 'me.alexisevelyn'
version '0.0.2-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    // License Compatibility - https://opensource.stackexchange.com/a/7908/9726
    // License (Dual Licensed Under EPL v1.0 and LGPL 2.1) - https://logback.qos.ch/license.html
    implementation "ch.qos.logback:logback-core:${project.logback_version}"
    shadow "ch.qos.logback:logback-core:${project.logback_version}"

    // License (Identical to MIT) - http://slf4j.org/license.html
    implementation "org.slf4j:slf4j-api:${project.slf4j_api_version}"
    shadow "org.slf4j:slf4j-api:${project.slf4j_api_version}"

    // License (MIT) - https://github.com/luaj/luaj/blob/master/LICENSE
    implementation "org.luaj:luaj-jse:${project.luaj_version}"
    shadow "org.luaj:luaj-jse:${project.luaj_version}"
}

//shadowJar {
//    archiveBaseName.set('shadow')
//    archiveClassifier.set('')
//    archiveVersion.set('')
//}

jar {
    manifest {
        attributes(
            'Main-Class': 'me.alexisevelyn.crewmate.Main'
        )
    }
}

// This is so build time properties like the server version are saved in the jar
// https://stackoverflow.com/a/54006518/6828099
processResources {
    filesMatching('compileTime.properties') {
        expand([build_version: version])
    }
}

test {
    useJUnitPlatform()
}